# è„šæœ¬ç›®å½•

æœ¬ç›®å½•åŒ…å«é¡¹ç›®çš„æ‰€æœ‰è„šæœ¬æ–‡ä»¶ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
scripts/
â”œâ”€â”€ docker/          # Docker ç›¸å…³è„šæœ¬
â”‚   â”œâ”€â”€ rebuild-docker.ps1
â”‚   â”œâ”€â”€ check-status.ps1
â”‚   â”œâ”€â”€ final-fix.ps1
â”‚   â””â”€â”€ ...
â”œâ”€â”€ utils/           # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ kill-mihomo.ps1
â”‚   â””â”€â”€ ...
â””â”€â”€ download-core.mjs  # ä¸‹è½½ Clash Core
```

## ğŸ³ Docker è„šæœ¬

### Windows ç”¨æˆ·

#### å¿«é€Ÿé‡å»ºå’Œéƒ¨ç½²
```powershell
.\docker\rebuild-docker.ps1
```
è‡ªåŠ¨å®Œæˆï¼šåœæ­¢æ—§å®¹å™¨ â†’ åˆ é™¤æ—§é•œåƒ â†’ æ„å»ºæ–°é•œåƒ â†’ éªŒè¯ â†’ å¯åŠ¨å®¹å™¨

#### æ£€æŸ¥çŠ¶æ€
```powershell
.\docker\check-status.ps1
```
æ£€æŸ¥ Dockerã€é•œåƒã€å®¹å™¨å’Œ mihomo æ–‡ä»¶çŠ¶æ€

#### å®Œæ•´ä¿®å¤æµç¨‹
```powershell
.\docker\final-fix.ps1
```
åˆ†é˜¶æ®µè¯Šæ–­å’Œä¿®å¤ Docker ç¯å¢ƒé—®é¢˜

#### è¯Šæ–­æ„å»ºé—®é¢˜
```powershell
.\docker\diagnose-build.ps1
```
ä½¿ç”¨è°ƒè¯•ç‰ˆ Dockerfile è¯Šæ–­æ„å»ºé—®é¢˜

### Linux/macOS ç”¨æˆ·

#### æ„å»ºé•œåƒ
```bash
./docker/build-docker.sh
```

#### é‡å»ºé•œåƒ
```bash
./docker/rebuild-docker.sh
```

#### å¯åŠ¨å®¹å™¨
```bash
./docker/start-docker.sh
```

#### ä¸‹è½½ Clash Core (Linux)
```bash
./docker/download-clash-linux.sh
```

## ğŸ”§ å·¥å…·è„šæœ¬

### ç»ˆæ­¢ Mihomo è¿›ç¨‹

#### Windows
```powershell
.\utils\kill-mihomo.ps1
```

#### Linux/macOS
```bash
./utils/kill-mihomo.sh
```

### å¿«é€Ÿå¯åŠ¨
```bash
./utils/quick-start.sh
```

## ğŸ“‹ è„šæœ¬è¯´æ˜

### rebuild-docker.ps1 / rebuild-docker.sh
**ç”¨é€”**: å®Œæ•´çš„ Docker é‡å»ºæµç¨‹

**åŠŸèƒ½**:
- åœæ­¢å¹¶åˆ é™¤æ—§å®¹å™¨
- åˆ é™¤æ—§é•œåƒ
- æ„å»ºæ–°é•œåƒ
- éªŒè¯ mihomo æ–‡ä»¶
- å¯åŠ¨æ–°å®¹å™¨
- æ˜¾ç¤ºæ—¥å¿—

**ä½¿ç”¨åœºæ™¯**:
- æ›´æ–°ä»£ç åé‡æ–°éƒ¨ç½²
- ä¿®å¤ Docker ç¯å¢ƒé—®é¢˜
- é¦–æ¬¡éƒ¨ç½²

### check-status.ps1
**ç”¨é€”**: æ£€æŸ¥ç³»ç»ŸçŠ¶æ€

**åŠŸèƒ½**:
- æ£€æŸ¥ Docker æ˜¯å¦è¿è¡Œ
- æ£€æŸ¥é•œåƒå’Œå®¹å™¨çŠ¶æ€
- éªŒè¯ mihomo æ–‡ä»¶
- æ˜¾ç¤ºæœ€è¿‘æ—¥å¿—
- ç»™å‡ºä¿®å¤å»ºè®®

**ä½¿ç”¨åœºæ™¯**:
- æ’æŸ¥é—®é¢˜å‰çš„è¯Šæ–­
- éªŒè¯éƒ¨ç½²æ˜¯å¦æˆåŠŸ
- æ—¥å¸¸çŠ¶æ€æ£€æŸ¥

### final-fix.ps1
**ç”¨é€”**: å®Œæ•´çš„ä¿®å¤æµç¨‹

**åŠŸèƒ½**:
- æµ‹è¯• builder é˜¶æ®µ
- æ„å»ºå®Œæ•´é•œåƒ
- éªŒè¯ runner é˜¶æ®µ
- å¯åŠ¨å®¹å™¨
- æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—

**ä½¿ç”¨åœºæ™¯**:
- mihomo æ–‡ä»¶ç¼ºå¤±
- æ„å»ºå¤±è´¥
- å®¹å™¨æ— æ³•å¯åŠ¨

### diagnose-build.ps1
**ç”¨é€”**: è¯Šæ–­æ„å»ºé—®é¢˜

**åŠŸèƒ½**:
- ä½¿ç”¨è°ƒè¯•ç‰ˆ Dockerfile
- åˆ†é˜¶æ®µéªŒè¯
- è¯¦ç»†çš„æ—¥å¿—è¾“å‡º
- æµ‹è¯•å®¹å™¨å¯åŠ¨

**ä½¿ç”¨åœºæ™¯**:
- æ„å»ºè¿‡ç¨‹ä¸­å‡ºé”™
- éœ€è¦è¯¦ç»†çš„æ„å»ºæ—¥å¿—
- æ’æŸ¥ mihomo ä¸‹è½½é—®é¢˜

### kill-mihomo.ps1 / kill-mihomo.sh
**ç”¨é€”**: ç»ˆæ­¢æ®‹ç•™çš„ mihomo è¿›ç¨‹

**åŠŸèƒ½**:
- æŸ¥æ‰¾æ‰€æœ‰ mihomo è¿›ç¨‹
- å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹
- æ¸…ç†ç«¯å£å ç”¨

**ä½¿ç”¨åœºæ™¯**:
- ç«¯å£è¢«å ç”¨
- è¿›ç¨‹å¡æ­»
- æ‰«ææ— æ³•å¯åŠ¨

## ğŸ¯ å¸¸è§ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: é¦–æ¬¡éƒ¨ç½²
```powershell
# 1. æ„å»ºå¹¶å¯åŠ¨
.\docker\rebuild-docker.ps1

# 2. æ£€æŸ¥çŠ¶æ€
.\docker\check-status.ps1
```

### åœºæ™¯ 2: æ›´æ–°ä»£ç åé‡æ–°éƒ¨ç½²
```powershell
# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# é‡å»ºé•œåƒ
.\docker\rebuild-docker.ps1
```

### åœºæ™¯ 3: é‡åˆ°é—®é¢˜
```powershell
# 1. æ£€æŸ¥çŠ¶æ€
.\docker\check-status.ps1

# 2. å¦‚æœæœ‰é—®é¢˜ï¼Œè¿è¡Œä¿®å¤
.\docker\final-fix.ps1

# 3. å¦‚æœè¿˜æœ‰é—®é¢˜ï¼Œè¿è¡Œè¯Šæ–­
.\docker\diagnose-build.ps1
```

### åœºæ™¯ 4: ç«¯å£è¢«å ç”¨
```powershell
# ç»ˆæ­¢ mihomo è¿›ç¨‹
.\utils\kill-mihomo.ps1

# é‡å¯å®¹å™¨
docker restart proxy-pool
```

## ğŸ“ è„šæœ¬å¼€å‘

### æ·»åŠ æ–°è„šæœ¬

1. åœ¨ç›¸åº”ç›®å½•åˆ›å»ºè„šæœ¬æ–‡ä»¶
2. æ·»åŠ è„šæœ¬è¯´æ˜æ³¨é‡Š
3. è®¾ç½®æ‰§è¡Œæƒé™ï¼ˆLinux/macOSï¼‰
4. æ›´æ–°æœ¬ README

### è„šæœ¬è§„èŒƒ

- Windows è„šæœ¬ä½¿ç”¨ `.ps1` æ‰©å±•å
- Linux/macOS è„šæœ¬ä½¿ç”¨ `.sh` æ‰©å±•å
- è„šæœ¬å¼€å¤´æ·»åŠ  shebang
- ä½¿ç”¨æœ‰æ„ä¹‰çš„å‡½æ•°å
- æ·»åŠ é”™è¯¯å¤„ç†
- è¾“å‡ºæ¸…æ™°çš„æ—¥å¿—ä¿¡æ¯

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [Docker éƒ¨ç½²æŒ‡å—](../docs/DOCKER.md)
- [æ•…éšœæ’æŸ¥](../docs/TROUBLESHOOTING.md)
- [Docker æ•…éšœæ’æŸ¥](../docs/DOCKER_TROUBLESHOOTING.md)

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Windows ç”¨æˆ·**: éœ€è¦ä»¥ç®¡ç†å‘˜æƒé™è¿è¡ŒæŸäº›è„šæœ¬
2. **Linux/macOS ç”¨æˆ·**: é¦–æ¬¡ä½¿ç”¨éœ€è¦æ·»åŠ æ‰§è¡Œæƒé™
   ```bash
   chmod +x scripts/docker/*.sh
   chmod +x scripts/utils/*.sh
   ```
3. **Docker Desktop**: ç¡®ä¿ Docker Desktop æ­£åœ¨è¿è¡Œ
4. **ç½‘ç»œ**: æŸäº›è„šæœ¬éœ€è¦è®¿é—® GitHubï¼Œå¯èƒ½éœ€è¦ä»£ç†
